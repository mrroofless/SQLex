--читерство, решено на оракле

select point,
       "date" income_date,
       "date" + nvl(
                  min(case when diff > cnt then cnt else null end),
                  max(cnt)+1
                ) incass_date
from (select i.point,
             i."date",
             (trunc(o."date") - trunc(i."date")) diff, -- разница дней
             -- количество запрещенных для инкассации дней после прихода и до текущего запрещенного дня
             count(1) over (partition by i.point, i."date" order by o."date" rows between unbounded preceding and current row)-1 cnt
      from income_o i
               join (select point, "date", 1 disabled from outcome_o
                     union
                     select point, trunc("date"+7,'DAY'), 1 disabled from income_o) o
                 on i.point = o.point
      where o."date" > = i."date")
group by point, "date"


--несовпадение данных
   select point,
       date income_date,   
	   date + isnull(
                  min(case when diff > cnt then cnt else null end),
                  max(cnt)+1
                ) incass_date
from (select i.point,
             i.date,
             (o.date - i.date) as diff, -- разница дней            
             count(1) over (partition by i.point, i.date order by o.date rows between unbounded preceding and current row)-1 cnt -- количество запрещенных для инкассации дней после прихода и до текущего запрещенного дня
      from income_o i
               join (select point, date, 1 disabled from outcome_o
                     union
                     select point, Dateadd(D, 7, date), 1 disabled from income_o) as o
                 on i.point = o.point
      where o.date > = i.date) as abc
group by point, date
